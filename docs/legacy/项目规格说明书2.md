

# 📑 Talk2Report 2.0 项目规格说明书 (DeepSeek Edition)

**版本**: v2.0-Draft
**日期**: 2026-01
**架构核心**: Multi-Agent Collaboration (多智能体协作)
**核心模型**: DeepSeek-R1 (推理/审稿) + DeepSeek-V3 (生成/提取)

---

## 1. 项目概述 (Executive Summary)

### 1.1 背景与痛点

Talk2Report 1.0 解决了“从零开始写总结”的冷启动问题，但仍存在以下局限：

* **线性提问呆板**：固定 12 问，无法根据用户回答进行深度挖掘。
* **逻辑自洽性弱**：AI 容易信口开河，缺乏对“证据与结论”之间逻辑关系的严格审查。
* **风格单一**：无法同时高质量地满足“向上汇报”和“社交分享”的差异化需求。

### 1.2 2.0 升级目标

利用 **DeepSeek-R1** 的思维链（CoT）能力和 **DeepSeek-V3** 的强大生成能力，构建一个**“咨询师+编辑部”**的虚拟团队。

* **深度访谈**：像真人咨询师一样，通过苏格拉底式提问挖掘用户潜在成就。
* **逻辑闭环**：引入“审稿人”角色，确保每条结论都有数据支撑。
* **极速生成**：利用 DeepSeek 低成本高并发优势，实现多版本并行输出。

---

## 2. 系统架构设计 (System Architecture)

### 2.1 技术栈 (Tech Stack)

| 层级 | 技术选型 | 说明 |
| --- | --- | --- |
| **前端** | React 18 + Tailwind + Lucide React | **Chat UI** 取代 StepWizard；增加 `<think>` 折叠组件。 |
| **BFF 层** | Vercel Serverless Functions | 处理流式响应，隐藏 n8n Webhook 地址，管理 Session。 |
| **编排层** | n8n (Self-hosted/Cloud) | 核心业务逻辑，管理多智能体状态流转。 |
| **模型层** | **DeepSeek API** | **R1 (Reasoner)**: 访谈、审稿<br>

<br>**V3 (Chat)**: 提取、写作 |
| **存储** | LocalStorage + KV (Optional) | 前端持久化对话，后端暂存生成的中间态 JSON。 |

### 2.2 数据流拓扑

```mermaid
graph TD
    User[用户前端 Chat UI] <--> BFF[Vercel BFF]
    BFF <-->|Webhooks| N8N[n8n 工作流引擎]
    
    subgraph "DeepSeek Intelligence Cloud"
        N8N <-->|推理请求| R1[DeepSeek-R1 (Interviewer/Critic)]
        N8N <-->|生成请求| V3[DeepSeek-V3 (Archivist/Writer)]
    end

```

---

## 3. 多智能体详细设计 (Agent Specifications)

### 🕵️ 智能体 A: 深度采访官 (The Interviewer)

* **核心模型**: **DeepSeek-R1**
* **人设**: 资深职业咨询师，擅长 STAR 原则挖掘。
* **Prompt 策略**:
* 启用 Chain of Thought (CoT)。
* **指令**: "分析用户的回答。如果用户只给了模糊结论（如'效率提升'），利用 CoT 思考其背后的实现路径，然后提出一个具体的追问（如'是通过工具自动化还是流程精简？具体提升了多少工时？'）。不要一次问两个问题。"


* **前端表现**: 展示 `Thinking...` 折叠块，让用户感知 AI 正在分析他的回答。

### 🗂️ 智能体 B: 事实整理员 (The Archivist)

* **核心模型**: **DeepSeek-V3**
* **人设**: 严谨的档案管理员。
* **任务**: 将非结构化的多轮对话记录，提取为结构化 JSON。
* **Schema 目标**:
```json
{
  "highlights": [{"project": "String", "metric": "String", "role": "String"}],
  "growth": ["String"],
  "missing_info": ["String"] // 标记缺失数据的部分
}

```



### ✍️ 智能体 C: 矩阵撰稿人 (The Writers)

* **核心模型**: **DeepSeek-V3**
* **并发模式**: 并行运行 3 个实例。
* **角色分工**:
1. **汇报版**: 简练、数据导向、金字塔原理 (Temperature: 1.0)。
2. **晋升版**: 侧重潜力、方法论沉淀、团队贡献 (Temperature: 1.1)。
3. **社交版**: 谦逊凡尔赛风、emoji、感性表达 (Temperature: 1.3)。



### ⚖️ 智能体 D: 毒舌审稿人 (The Critic)

* **核心模型**: **DeepSeek-R1**
* **人设**: 挑剔的 CEO 或 逻辑学家。
* **任务**: 检查 **Agent C** 产出的初稿。
* **逻辑检查 (R1 强项)**:
* "文中的‘业绩翻倍’是否有前文的数据支持？"
* "因果关系是否成立？（是因为你努力还是因为市场大盘涨了？）"


* **输出**: 若评分 < 80 分，返回具体的修改建议 JSON，触发 Agent C 重写。

---

## 4. 核心功能流程 (Core Workflows)

### 4.1 阶段一：动态深度访谈 (Dynamic Interview)

1. **初始化**: 用户输入基本信息（职位、年度关键词）。
2. **交互循环**:
* 用户回答问题。
* **BFF** 将 `{history, current_answer}` 发送给 n8n。
* **Agent A (R1)** 思考（`<think>`: 用户缺乏数据支撑...），生成追问。
* **前端** 解析返回，折叠 `<think>` 内容，显示追问问题。


3. **终止条件**: 达到预设轮次（如 10 轮）或 Agent A 判断 `info_sufficient: true`。

### 4.2 阶段二：异步生成与质量闭环 (Generation & Refinement)

1. **触发**: 用户点击“生成报告”。
2. **提取**: **Agent B (V3)** 将对话历史转化为 `FactSheet.json`。
3. **初稿**: **Agent C (V3)** 基于 `FactSheet` 生成 Version 1.0。
4. **审计 (The Loop)**:
* **Agent D (R1)** 读取 Version 1.0 + FactSheet。
* 进行逻辑推理，输出 `ReviewReport`。
* **判定**:
* Pass: 直接输出。
* Reject: 将 `ReviewReport` 发回给 Agent C，进行 Version 2.0 修正。




5. **交付**: 前端收到最终 JSON，渲染 4 个版本的卡片。

---

## 5. 前端交互设计 (UI/UX)

### 5.1 聊天界面 (Chat Interface)

* **风格**: 类似 ChatGPT/Claude，但更专注于引导。
* **特色组件**:
* **Thinking Process**: 既然用 R1，就要把它的“思考过程”作为产品亮点展示（默认折叠，点击展开），增加专业感。
* **Input Guide**: 根据上一轮问题，动态提示建议的回答格式（例如：“试着包含具体数字...”）。



### 5.2 智能体终端 (Agent Terminal)

* **位置**: 生成页面右侧或底部抽屉。
* **内容**: 实时显示 n8n 工作流状态。
* `> [Archivist] Extracting 14 key facts...`
* `> [Writer] Drafting "Promotion Version"...`
* `> [Critic] ⚠️ Logic Error detected in Section 2, requesting rewrite...` (红色高亮)


* **价值**: 缓解生成过程（可能需 30s+）的等待焦虑，展示 AI 的工作量。

---

## 6. 数据结构 (Data Schema)

### 6.1 访谈历史 (LocalStorage)

```javascript
[
  { "role": "assistant", "content": "今年最让你自豪的项目是什么？", "think": "..." },
  { "role": "user", "content": "重构了支付系统。" },
  { "role": "assistant", "content": "这很难得。重构后性能提升了多少？有减少客诉吗？", "think": "用户只说了动作，没说结果..." }
]

```

### 6.2 最终交付物 (Final Output)

```json
{
  "report_id": "uuid",
  "meta": { "user_role": "Product Manager", "year": 2024 },
  "versions": {
    "brief": { "title": "200字电梯汇报", "content": "..." },
    "formal": { "title": "正式年度述职", "content": "..." },
    "social": { "title": "朋友圈文案", "content": "..." },
    "slides_outline": { "title": "PPT大纲", "content": [...] }
  },
  "audit_log": "通过逻辑审查，修正了 2 处数据引用错误。"
}

```

---

## 7. 实施路线图 (Roadmap)

### Phase 1: 核心替换 (DeepSeek Migration)

* **目标**: 跑通基于 DeepSeek 的基础问答。
* **任务**:
* BFF 对接 DeepSeek API。
* 将 Prompt 迁移适配 DeepSeek-V3。
* 实现前端 Markdown 渲染（含 `<think>` 标签支持）。



### Phase 2: R1 赋能 (Reasoning Integration)

* **目标**: 实现“深度访谈”。
* **任务**:
* 设计 Agent A (Interviewer) 的 CoT Prompt。
* n8n 中配置访谈循环逻辑。



### Phase 3: 质量闭环 (The Critic Loop)

* **目标**: 实现“审稿-修改”自动化。
* **任务**:
* n8n 实现 `If-Else` 回环路由。
* 设计 Agent D (Critic) 的评分标准。
* 前端实现 Agent Terminal 可视化。



---

## 8. 成功指标 (Success Metrics)

1. **对话深度**: 用户平均回复字数提升 30%（因追问更具体）。
2. **修改率降低**: 用户生成后手动修改的字符数减少 40%（因逻辑更自洽）。
3. **完读率**: R1 的思考过程展开率 > 20%（用户对 AI 的思考感兴趣）。