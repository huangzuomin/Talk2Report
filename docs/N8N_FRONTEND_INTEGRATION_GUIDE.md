# n8n å·¥ä½œæµ + å‰ç«¯é›†æˆè°ƒè¯•æ–¹æ¡ˆ

## ğŸ¯ ç›®æ ‡

å°†ä¸¤ä¸ª n8n å·¥ä½œæµä¸ Talk2Report å‰ç«¯åº”ç”¨è¿›è¡Œé›†æˆæµ‹è¯•å’Œè°ƒè¯•ã€‚

## ğŸ“‹ å·¥ä½œæµä¿¡æ¯

### 1. Interview Workflow (Agent A)
- **å·¥ä½œæµ ID**: ZB3l0CZyO7w79Y95
- **Webhook URL**: `https://n8n.neican.ai/webhook/interview/next-step`
- **åŠŸèƒ½**: é‡‡è®¿å¯¹è¯ï¼Œé€šè¿‡æé—®æå–ç”¨æˆ·æˆå°±
- **çŠ¶æ€**: âœ… å·²éªŒè¯å·¥ä½œæ­£å¸¸

### 2. Generate Workflow (Agent B+C+D)
- **å·¥ä½œæµ ID**: D05OBJW6XTAgOJjo
- **Webhook URL**: `https://n8n.neican.ai/webhook/generate`
- **åŠŸèƒ½**: ç”Ÿæˆå¹´ç»ˆæŠ¥å‘Š
- **çŠ¶æ€**: âš ï¸ Agent B æ•°æ®æå–éœ€è¦ä¼˜åŒ–

## ğŸ”§ é›†æˆå‰é…ç½®æ£€æŸ¥

### ç¯å¢ƒå˜é‡é…ç½®

åœ¨ `.env.local` ä¸­ç¡®è®¤ä»¥ä¸‹é…ç½®ï¼š

```bash
# n8n Webhook URLs
N8N_INTERVIEW_URL=https://n8n.neican.ai/webhook/interview/next-step
N8N_GENERATE_URL=https://n8n.neican.ai/webhook/generate

# n8n è®¤è¯
N8N_AUTH_TOKEN=NeicanSTT2025Secret

# DeepSeek APIï¼ˆå‰ç«¯ç›´æ¥ä½¿ç”¨ï¼‰
DEEPSEEK_API_KEY=sk-xxx

# n8n REST APIï¼ˆå¯é€‰ï¼Œç”¨äºè°ƒè¯•ï¼‰
N8N_API_BASE=http://192.168.50.224:30109/api/v1
N8N_API_KEY=your-api-key
```

## ğŸ§ª é›†æˆæµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è¿™ä¼šå¯åŠ¨ï¼š
- Express API Server (port 3001) - å¤„ç† `/api/deepseek/*` è·¯ç”±
- Vite Dev Server (port 5173) - å‰ç«¯ç•Œé¢

### æ­¥éª¤ 2: æµ‹è¯• Interview Workflow é›†æˆ

**æµ‹è¯•ç›®æ ‡**: éªŒè¯å‰ç«¯ä¸ Interview Workflow çš„äº¤äº’

**æµ‹è¯•å†…å®¹**:
1. æ‰“å¼€å‰ç«¯åº”ç”¨: `http://localhost:5173`
2. è¿›å…¥ Interview ç•Œé¢
3. å‘é€æµ‹è¯•æ¶ˆæ¯
4. éªŒè¯ Agent A æé—®ç”Ÿæˆ
5. éªŒè¯å¯¹è¯å†å²ä¿å­˜
6. éªŒè¯çŠ¶æ€æ›´æ–°

**é¢„æœŸç»“æœ**:
- âœ… å‰ç«¯æˆåŠŸè°ƒç”¨ n8n webhook
- âœ… è¿”å›ç¬¬ä¸€æ¬¡æé—®
- âœ… æ˜¾ç¤ºåœ¨èŠå¤©ç•Œé¢
- âœ… å“åº”æ—¶é—´ < 2ç§’

### æ­¥éª¤ 3: æµ‹è¯• Generate Workflow é›†æˆ

**æµ‹è¯•ç›®æ ‡**: éªŒè¯å‰ç«¯ä¸ Generate Workflow çš„äº¤äº’

**æµ‹è¯•å†…å®¹**:
1. å®Œæˆ Interviewï¼ˆè‡³å°‘ 3-5 è½®å¯¹è¯ï¼‰
2. ç‚¹å‡»"ç”ŸæˆæŠ¥å‘Š"æŒ‰é’®
3. é€‰æ‹©æŠ¥å‘Šåå¥½
4. éªŒè¯ Agent B+C+D æµç¨‹
5. éªŒè¯æŠ¥å‘Šç”Ÿæˆå’Œæ˜¾ç¤º

**é¢„æœŸç»“æœ**:
- âš ï¸ å‰ç«¯æˆåŠŸè°ƒç”¨ n8n webhook
- âš ï¸ Agent B å¯èƒ½è¿”å›ç©ºæ•°æ®ï¼ˆå·²çŸ¥é—®é¢˜ï¼‰
- âš ï¸ éœ€è¦è°ƒè¯•æ•°æ®æå–é€»è¾‘

### æ­¥éª¤ 4: ç«¯åˆ°ç«¯æµ‹è¯•

**å®Œæ•´æµç¨‹**:
1. ç”¨æˆ·è¿›å…¥åº”ç”¨
2. è®¾ç½®è§’è‰²å’Œåå¥½
3. å¼€å§‹ Interviewï¼ˆAgent Aï¼‰
4. å®Œæˆå¯¹è¯é‡‡é›†
5. ç”ŸæˆæŠ¥å‘Šï¼ˆAgent B+C+Dï¼‰
6. æŸ¥çœ‹å’Œå¯¼å‡ºæŠ¥å‘Š

## ğŸ› å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1: Agent B æ•°æ®æå–å¤±è´¥

**ç—‡çŠ¶**: Agent B è¿”å›ç©ºå¯¹è±¡æˆ–å…¨ null

**ä¸´æ—¶è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨å‰ç«¯çš„ DeepSeek APIï¼ˆç»•è¿‡ n8nï¼‰

**æ°¸ä¹…è§£å†³æ–¹æ¡ˆ**: ä¿®å¤ n8n å·¥ä½œæµä¸­ Agent B çš„é…ç½®

### é—®é¢˜ 2: å“åº”è¶…æ—¶

**ç—‡çŠ¶**: Generate Workflow è¶…æ—¶ï¼ˆ> 2åˆ†é’Ÿï¼‰

**è§£å†³æ–¹æ¡ˆ**:
- ä¼˜åŒ– Agent B çš„ user message è¡¨è¾¾å¼
- æˆ–è€…ç®€åŒ–å·¥ä½œæµï¼Œåˆ†æ­¥éª¤æ‰§è¡Œ

## ğŸ“Š è°ƒè¯•å·¥å…·

### 1. å‰ç«¯è°ƒè¯•

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š
- Console: æŸ¥çœ‹ API è°ƒç”¨
- Network: æŸ¥çœ‹è¯·æ±‚/å“åº”
- React DevTools: æŸ¥çœ‹ç»„ä»¶çŠ¶æ€

### 2. n8n æ‰§è¡Œæ—¥å¿—

è®¿é—®: `http://192.168.50.224:30109/workflow/{workflowId}/executions`

æŸ¥çœ‹ï¼š
- æ‰§è¡ŒçŠ¶æ€
- æ‰§è¡Œæ—¶é—´
- èŠ‚ç‚¹è¾“å‡º

### 3. æµ‹è¯•è„šæœ¬

```bash
# æµ‹è¯• Interview Workflow
node n8n_workflows/tests/test_interview_workflow.js

# æµ‹è¯• Generate Workflow
node n8n_workflows/tests/test_all_branches.js

# æ£€æŸ¥æ‰§è¡Œæ—¥å¿—
node n8n_workflows/tests/check_new_execs.js
```

## ğŸ“ é›†æˆæµ‹è¯•æ£€æŸ¥æ¸…å•

### Interview Workflow é›†æˆ

- [ ] å‰ç«¯æˆåŠŸå¯åŠ¨ (`npm run dev`)
- [ ] ç¯å¢ƒå˜é‡æ­£ç¡®é…ç½®
- [ ] Interview ç•Œé¢å¯è®¿é—®
- [ ] å‘é€æ¶ˆæ¯æˆåŠŸ
- [ ] æ¥æ”¶ Agent A æé—®
- [ ] å¯¹è¯å†å²æ­£ç¡®æ˜¾ç¤º
- [ ] çŠ¶æ€æ›´æ–°æ­£å¸¸ï¼ˆå®Œæˆåº¦ç­‰ï¼‰
- [ ] å“åº”æ—¶é—´ < 2ç§’

### Generate Workflow é›†æˆ

- [ ] å®Œæˆ Interview åå¯è¿›å…¥ç”Ÿæˆé˜¶æ®µ
- [ ] æŠ¥å‘Šåå¥½è®¾ç½®æ­£å¸¸
- [ ] ç‚¹å‡»"ç”ŸæˆæŠ¥å‘Š"è§¦å‘å·¥ä½œæµ
- [ ] å‰ç«¯æ˜¾ç¤ºç”Ÿæˆè¿›åº¦
- [ ] æ¥æ”¶ç”Ÿæˆçš„æŠ¥å‘Šï¼ˆæˆ–é”™è¯¯ä¿¡æ¯ï¼‰
- [ ] æŠ¥å‘Šæ­£ç¡®æ¸²æŸ“ï¼ˆmarkdownï¼‰

### é”™è¯¯å¤„ç†

- [ ] ç½‘ç»œé”™è¯¯æ­£ç¡®æ˜¾ç¤º
- [ ] API é”™è¯¯æ­£ç¡®æ˜¾ç¤º
- [ ] è¶…æ—¶é”™è¯¯æ­£ç¡®å¤„ç†
- [ ] ç”¨æˆ·å¯ä»¥é‡è¯•

## ğŸ¯ è°ƒè¯•ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§ (P0)

1. **Interview Workflow é›†æˆ** - éªŒè¯åŸºç¡€å¯¹è¯åŠŸèƒ½
2. **å‰ç«¯å¯åŠ¨å’Œç¯å¢ƒ** - ç¡®ä¿å¼€å‘ç¯å¢ƒæ­£å¸¸
3. **API è°ƒç”¨é“¾è·¯** - å‰ç«¯ â†’ n8n webhook â†’ DeepSeek

### ä¸­ä¼˜å…ˆçº§ (P1)

4. **Generate Workflow é›†æˆ** - æµ‹è¯•æŠ¥å‘Šç”Ÿæˆæµç¨‹
5. **é”™è¯¯å¤„ç†** - ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
6. **çŠ¶æ€ç®¡ç†** - å¯¹è¯å†å²ä¿å­˜

### ä½ä¼˜å…ˆçº§ (P2)

7. **æ€§èƒ½ä¼˜åŒ–** - å‡å°‘å“åº”æ—¶é—´
8. **UI/UX æ”¹è¿›** - åŠ è½½åŠ¨ç”»ã€è¿›åº¦æ¡ç­‰
9. **æ—¥å¿—è®°å½•** - å‰ç«¯å’Œåç«¯æ—¥å¿—

## ğŸš€ å¼€å§‹é›†æˆæµ‹è¯•

### å‘½ä»¤

```bash
# 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 2. åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œæµ‹è¯•è„šæœ¬ï¼ˆå¯é€‰ï¼‰
# ç›‘æ§ n8n æ‰§è¡Œ
node n8n_workflows/tests/check_new_execs.js

# 3. æ‰“å¼€æµè§ˆå™¨
# http://localhost:5173
```

### æµ‹è¯•æµç¨‹

1. **æ‰“å¼€å‰ç«¯åº”ç”¨**
   - è®¿é—® `http://localhost:5173`
   - æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

2. **æµ‹è¯• Interview Workflow**
   - ç‚¹å‡»"å¼€å§‹è®¿è°ˆ"
   - å‘é€æµ‹è¯•æ¶ˆæ¯
   - æŸ¥çœ‹ Agent A çš„æé—®
   - è¿›è¡Œ 3-5 è½®å¯¹è¯

3. **æµ‹è¯• Generate Workflow**
   - å®Œæˆè®¿è°ˆåç‚¹å‡»"ç”ŸæˆæŠ¥å‘Š"
   - è®¾ç½®æŠ¥å‘Šåå¥½
   - æŸ¥çœ‹ç”Ÿæˆè¿›åº¦
   - æŸ¥çœ‹ç”Ÿæˆçš„æŠ¥å‘Š

4. **è®°å½•é—®é¢˜**
   - æˆªå›¾é”™è¯¯ä¿¡æ¯
   - è®°å½•æ§åˆ¶å°æ—¥å¿—
   - è®°å½• n8n æ‰§è¡Œæ—¥å¿—

## ğŸ“„ é¢„æœŸæµ‹è¯•ç»“æœ

### âœ… æˆåŠŸåœºæ™¯

```
ç”¨æˆ· â†’ å‰ç«¯ç•Œé¢
  â†“ å‘é€æ¶ˆæ¯
å‰ç«¯ â†’ n8n Interview Workflow
  â†“ Agent A ç”Ÿæˆæé—®
n8n â†’ DeepSeek API
  â†“ è¿”å›é—®é¢˜
å‰ç«¯ â†’ æ˜¾ç¤ºæé—®
  â†“ ç”¨æˆ·å›ç­”
é‡å¤ 3-5 æ¬¡...

ç”¨æˆ· â†’ ç‚¹å‡»"ç”ŸæˆæŠ¥å‘Š"
  â†“
å‰ç«¯ â†’ n8n Generate Workflow
  â†“ Agent B â†’ Agent C â†’ Agent D
n8n â†’ DeepSeek API (å¤šæ¬¡è°ƒç”¨)
  â†“
å‰ç«¯ â†’ æ˜¾ç¤ºç”Ÿæˆçš„æŠ¥å‘Š
```

### âŒ å¤±è´¥åœºæ™¯ï¼ˆå·²çŸ¥ï¼‰

```
Agent B æ•°æ®æå–å¤±è´¥
â†’ è¿”å›ç©ºå¯¹è±¡
â†’ å‰ç«¯æ˜¾ç¤ºé”™è¯¯
â†’ å»ºè®®ä½¿ç”¨å‰ç«¯ DeepSeek API
```

## ğŸ’¡ è°ƒè¯•æŠ€å·§

### 1. ä½¿ç”¨æµè§ˆå™¨ Network é¢æ¿

- æŸ¥çœ‹è¯·æ±‚ URL
- æŸ¥çœ‹è¯·æ±‚ä½“
- æŸ¥çœ‹å“åº”ä½“
- æŸ¥çœ‹å“åº”æ—¶é—´

### 2. ä½¿ç”¨ n8n æ‰§è¡Œæ—¥å¿—

- è®¿é—®å·¥ä½œæµæ‰§è¡Œé¡µé¢
- ç‚¹å‡»å¤±è´¥çš„æ‰§è¡Œ
- æŸ¥çœ‹å“ªä¸ªèŠ‚ç‚¹å‡ºé”™
- æŸ¥çœ‹èŠ‚ç‚¹è¾“å‡ºæ•°æ®

### 3. ä½¿ç”¨å‰ç«¯ console.log

åœ¨å…³é”®ä½ç½®æ·»åŠ æ—¥å¿—ï¼š
```javascript
console.log('å‘é€è¯·æ±‚åˆ° n8n:', payload);
console.log('n8n å“åº”:', response);
console.log('Agent æé—®:', question);
```

### 4. åˆ†æ­¥éª¤æµ‹è¯•

- å…ˆæµ‹è¯• Interviewï¼Œå†æµ‹è¯• Generate
- å…ˆæµ‹è¯•ç®€å•æ•°æ®ï¼Œå†æµ‹è¯•å¤æ‚æ•°æ®
- å…ˆæµ‹è¯•å•æ¬¡è°ƒç”¨ï¼Œå†æµ‹è¯•å¤šæ¬¡è°ƒç”¨

## ğŸ“ éœ€è¦å¸®åŠ©

å¦‚æœåœ¨é›†æˆè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
2. Network é¢æ¿çš„è¯·æ±‚/å“åº”
3. n8n æ‰§è¡Œæ—¥å¿—æˆªå›¾
4. å‰ç«¯ç•Œé¢æˆªå›¾
