# Talk2Report æ··åˆæ¶æ„æ–¹æ¡ˆ

## ğŸ¯ æ¶æ„æ¦‚è¿°

é‡‡ç”¨æ··åˆæ¶æ„ï¼Œç»“åˆå‰ç«¯ç›´æ¥è°ƒç”¨å’Œ n8n å·¥ä½œæµçš„ä¼˜åŠ¿ï¼š

- **Interview é˜¶æ®µ**: å‰ç«¯ç›´æ¥è°ƒç”¨ DeepSeek API (å¿«é€Ÿ)
- **Generate é˜¶æ®µ**: n8n å·¥ä½œæµç¼–æ’ (å¼ºå¤§)

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

### ä¸ºä»€ä¹ˆé€‰æ‹©æ··åˆæ–¹æ¡ˆï¼Ÿ

| é˜¶æ®µ | è°ƒç”¨æ–¹å¼ | åŸå›  |
|------|---------|------|
| **Interview** | å‰ç«¯ç›´æ¥è°ƒç”¨ | â€¢ ç”¨æˆ·éœ€è¦å¿«é€Ÿå“åº” (1-3ç§’)<br>â€¢ é¢‘ç¹è°ƒç”¨ (æ¯è½®å¯¹è¯)<br>â€¢ é€»è¾‘ç®€å•ï¼Œä¸éœ€è¦ç¼–æ’ |
| **Generate** | n8n å·¥ä½œæµ | â€¢ ä¸€æ¬¡æ€§è°ƒç”¨ï¼Œå¤æ‚ç¼–æ’<br>â€¢ å¤š Agent åä½œ (Bâ†’Câ†’D)<br>â€¢ éœ€è¦å¯è§†åŒ–å’Œè°ƒè¯•<br>â€¢ éæŠ€æœ¯äººå‘˜å¯ä¼˜åŒ– |

---

## ğŸ”„ æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Interview é˜¶æ®µ                          â”‚
â”‚                                                               â”‚
â”‚  ç”¨æˆ· â†’ ChatInterfaceV2 â†’ useInterviewMachine               â”‚
â”‚                              â†“                                â”‚
â”‚                      callAgentA()                           â”‚
â”‚                              â†“                                â”‚
â”‚              Express API (localhost:3001)                    â”‚
â”‚                              â†“                                â”‚
â”‚              DeepSeek API (deepseek-chat)                   â”‚
â”‚                                                               â”‚
â”‚  âš¡ å“åº”æ—¶é—´: 1-3ç§’                                           â”‚
â”‚  ğŸ’¾ ä¿å­˜: sessionId + conversationHistory                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Generate é˜¶æ®µ                           â”‚
â”‚                                                               â”‚
â”‚  å‰ç«¯ â†’ useReportGeneration â†’ generateReportWithN8N()        â”‚
â”‚                                    â†“                         â”‚
â”‚                        n8n Webhook                            â”‚
â”‚                                    â†“                         â”‚
â”‚   Agent B (æå–) â†’ Agent C (ç”ŸæˆÃ—3) â†’ Agent D (å®¡æŸ¥)       â”‚
â”‚                                    â†“                         â”‚
â”‚                        è¿”å›3ä¸ªç‰ˆæœ¬æŠ¥å‘Š                         â”‚
â”‚                                                               â”‚
â”‚  â±ï¸  å“åº”æ—¶é—´: 20-30ç§’                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ æŠ€æœ¯é…ç½®

### Interview é˜¶æ®µé…ç½®

**æ¨¡å‹**: `deepseek-chat`
- âœ… å¿«é€Ÿå“åº” (1-3ç§’)
- âœ… æˆæœ¬ä½
- âš ï¸ æ— æ€è€ƒè¿‡ç¨‹å±•ç¤º

**è°ƒç”¨é“¾**:
```javascript
ç”¨æˆ·è¾“å…¥
  â†“
useInterviewMachine (å‰ç«¯ hook)
  â†“
callAgentA() (src/lib/deepseek-client.js)
  â†“
Express API (localhost:3001)
  â†“
DeepSeek API
```

**å…³é”®ä»£ç **:
```javascript
export async function callAgentA(conversationHistory, onThink) {
  return callDeepSeek({
    model: 'deepseek-chat', // å¿«é€Ÿæ¨¡å‹
    messages: conversationHistory,
    temperature: 0.7,
    stream: false,
  });
}
```

### Generate é˜¶æ®µé…ç½®

**å·¥ä½œæµ**: n8n Generate Workflow
- Agent B: æ•°æ®æå– (Archivist)
- Agent C: å¹¶è¡Œç”Ÿæˆ3ä¸ªç‰ˆæœ¬ (Writers)
- Agent D: è´¨é‡å®¡æŸ¥ (Critic)

**è°ƒç”¨é“¾**:
```javascript
å®Œæˆè®¿è°ˆ
  â†“
useReportGeneration (å‰ç«¯ hook)
  â†“
generateReportWithN8N()
  â†“
n8n Webhook (https://n8n.neican.ai/webhook/generate)
  â†“
Agent B â†’ Agent C â†’ Agent D
  â†“
è¿”å›3ä¸ªç‰ˆæœ¬çš„æŠ¥å‘Š
```

**å…³é”®ä»£ç **:
```javascript
export async function generateReportWithN8N({
  conversationHistory,
  preferences,
  sessionId
}) {
  const response = await fetch(N8N_GENERATE_URL, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${N8N_AUTH_TOKEN}`
    },
    body: JSON.stringify({
      session_id: sessionId,
      conversation_history: conversationHistory,
      preferences
    })
  });
}
```

---

## ğŸ”‘ ç¯å¢ƒå˜é‡

### å¿…éœ€é…ç½®

```bash
# DeepSeek API (Interview é˜¶æ®µä½¿ç”¨)
DEEPSEEK_API_KEY=sk-xxx
DEEPSEEK_API_BASE=https://api.deepseek.com

# n8n å·¥ä½œæµ (Generate é˜¶æ®µä½¿ç”¨)
N8N_GENERATE_URL=https://n8n.neican.ai/webhook/generate
N8N_AUTH_TOKEN=NeicanSTT2025Secret
```

### å¯é€‰é…ç½®

```bash
# n8n REST API (ç”¨äºè°ƒè¯•)
N8N_API_BASE=http://192.168.50.224:30109/api/v1
N8N_API_KEY=xxx
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### Interview é˜¶æ®µ

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| å“åº”æ—¶é—´ | 1-3ç§’ | é¦–è½®å¯¹è¯ |
| å“åº”æ—¶é—´ | 1-2ç§’ | åç»­å¯¹è¯ |
| æ¨¡å‹ | deepseek-chat | å¿«é€Ÿæ¨¡å‹ |
| æ¸©åº¦ | 0.7 | å¹³è¡¡åˆ›é€ æ€§å’Œä¸€è‡´æ€§ |

### Generate é˜¶æ®µ

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| æ€»å“åº”æ—¶é—´ | 20-30ç§’ | åŒ…å«3ä¸ª Agent |
| Agent B | ~5ç§’ | æ•°æ®æå– |
| Agent C | ~10ç§’ | å¹¶è¡Œç”Ÿæˆ3ç‰ˆæœ¬ |
| Agent D | ~5ç§’ | è´¨é‡å®¡æŸ¥ |
| è¿­ä»£æ¬¡æ•° | 1-2æ¬¡ | å¦‚æœè´¨é‡ä¸è¾¾æ ‡ |

---

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ä¿®æ”¹ Interview æç¤ºè¯

ç›´æ¥ä¿®æ”¹å‰ç«¯ä»£ç ï¼Œåˆ·æ–°é¡µé¢å³å¯ç”Ÿæ•ˆï¼š

**æ–‡ä»¶**: `src/hooks/useDeepSeek.js` æˆ– `src/hooks/useInterviewMachine.js`

```javascript
const systemPrompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„è®¿è°ˆåŠ©æ‰‹...`;
```

### ä¿®æ”¹ Generate å·¥ä½œæµ

éœ€è¦ä¿®æ”¹ n8n å·¥ä½œæµï¼š

1. è®¿é—®: http://192.168.50.224:30109/workflow/D05OBJW6XTAgOJjo
2. ç¼–è¾‘å¯¹åº”èŠ‚ç‚¹
3. ä¿å­˜å¹¶æ¿€æ´»

### è°ƒè¯•æŠ€å·§

**Interview é˜¶æ®µ**:
- æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°
- æŸ¥çœ‹æ—¥å¿—: `[Interview Local]`
- æ£€æŸ¥ç½‘ç»œè¯·æ±‚: `/api/deepseek/chat`

**Generate é˜¶æ®µ**:
- æŸ¥çœ‹ Agent Terminal (å‰ç«¯ç•Œé¢)
- è®¿é—® n8n æ‰§è¡Œæ—¥å¿—
- URL: `http://192.168.50.224:30109/workflow/D05OBJW6XTAgOJjo/executions`

---

## âœ… éªŒè¯é…ç½®

è¿è¡ŒéªŒè¯è„šæœ¬ï¼š

```bash
node n8n_workflows/tests/verify_hybrid_setup.js
```

é¢„æœŸè¾“å‡ºï¼š
```
âœ… useInterview ä½¿ç”¨å‰ç«¯ç›´æ¥è°ƒç”¨
âœ… æ¨¡å‹: deepseek-chat (å¿«é€Ÿ)
âœ… useReportGeneration ä½¿ç”¨ n8n å·¥ä½œæµ
âœ… sessionId æ­£ç¡®è¿½è¸ªå’Œä¼ é€’

ğŸ‰ æ··åˆæ–¹æ¡ˆé…ç½®æ­£ç¡®ï¼
```

---

## ğŸš€ ä¼˜åŠ¿æ€»ç»“

### Interview é˜¶æ®µä¼˜åŠ¿

âœ… **å¿«é€Ÿå“åº”** - 1-3ç§’ï¼Œç”¨æˆ·ä½“éªŒå¥½
âœ… **å®æ—¶ä¿®æ”¹** - æç¤ºè¯æ”¹åŠ¨ç«‹å³ç”Ÿæ•ˆ
âœ… **ç®€å•ç›´æ¥** - ä¸ä¾èµ–å¤–éƒ¨æœåŠ¡
âœ… **æˆæœ¬ä½** - chat æ¨¡å‹æ¯” reasoner ä¾¿å®œ

### Generate é˜¶æ®µä¼˜åŠ¿

âœ… **å¼ºå¤§ç¼–æ’** - å¤š Agent åä½œ
âœ… **å¯è§†åŒ–è°ƒè¯•** - n8n UI ç›´è§‚
âœ… **éæŠ€æœ¯äººå‘˜å‹å¥½** - äº§å“ç»ç†å¯ç›´æ¥ä¼˜åŒ–
âœ… **å¯è§‚æµ‹æ€§å¼º** - å®Œæ•´æ‰§è¡Œæ—¥å¿—

### æ•´ä½“ä¼˜åŠ¿

âœ… **æœ€ä½³æ€§èƒ½** - Interview å¿«ï¼ŒGenerate å¼º
âœ… **çµæ´»å¼€å‘** - å‰ç«¯ä»£ç å®æ—¶ä¿®æ”¹
âœ… **æ˜“äºç»´æŠ¤** - èŒè´£æ¸…æ™°åˆ†ç¦»
âœ… **æ‰©å±•æ€§å¥½** - å¯ä»¥ç‹¬ç«‹ä¼˜åŒ–å„é˜¶æ®µ

---

## ğŸ’¡ æœªæ¥ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸ (1-2å‘¨)

1. **ä¼˜åŒ– Interview æç¤ºè¯**
   - å‡å°‘æç¤ºè¯é•¿åº¦
   - æé«˜é—®é¢˜è´¨é‡

2. **ä¼˜åŒ– Generate å·¥ä½œæµ**
   - ä¿®å¤ Agent B æ•°æ®æå–é—®é¢˜
   - å‡å°‘å“åº”æ—¶é—´è‡³ 15-20ç§’

### ä¸­æœŸ (1ä¸ªæœˆ)

3. **æ·»åŠ ç¼“å­˜æœºåˆ¶**
   - ç¼“å­˜å¸¸è§å¼€åœºç™½
   - å‡å°‘é‡å¤è°ƒç”¨

4. **æ·»åŠ æµå¼è¾“å‡º**
   - Generate é˜¶æ®µæ˜¾ç¤ºå®æ—¶è¿›åº¦
   - æå‡ç”¨æˆ·ä½“éªŒ

### é•¿æœŸ (3ä¸ªæœˆ)

5. **è€ƒè™‘å‰ç«¯ RAG**
   - æœ¬åœ°å‘é‡æ•°æ®åº“
   - å®Œå…¨ç¦»çº¿è¿è¡Œ

6. **å¤šæ¨¡å‹æ”¯æŒ**
   - æ”¯æŒå…¶ä»– LLM æä¾›å•†
   - A/B æµ‹è¯•ä¸åŒæ¨¡å‹

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- `docs/N8N_FRONTEND_INTEGRATION_GUIDE.md` - n8n é›†æˆæŒ‡å—
- `docs/OPTIMIZE_INTERVIEW_SPEED.md` - æ€§èƒ½ä¼˜åŒ–æŒ‡å—
- `CLAUDE.md` - é¡¹ç›®æ¶æ„æ–‡æ¡£

---

**æœ€åæ›´æ–°**: 2026-01-03
**ç‰ˆæœ¬**: 2.0 (æ··åˆæ¶æ„)
