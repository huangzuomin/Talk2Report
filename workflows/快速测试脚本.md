# å¿«é€Ÿæµ‹è¯•è„šæœ¬

## PowerShell ç‰ˆæœ¬ï¼ˆæ¨èï¼‰

```powershell
# å¿«é€Ÿæµ‹è¯• n8n å·¥ä½œæµ
# ä½¿ç”¨æ–¹æ³•: .\quick-test.ps1

# ========== é…ç½®åŒº ==========
$WEBHOOK_URL = "https://n8n.neican.ai/webhook/generate"
$AUTH_TOKEN = "YOUR_TOKEN_HERE"  # æ›¿æ¢ä¸ºä½ çš„å®é™… Token
$TEST_DATA_FILE = "æµ‹è¯•æ•°æ®_å·¥ä½œæ€»ç»“ç”Ÿæˆ.json"
# ============================

# è¯»å–æµ‹è¯•æ•°æ®
Write-Host "ğŸ“– è¯»å–æµ‹è¯•æ•°æ®: $TEST_DATA_FILE" -ForegroundColor Cyan
$testData = Get-Content $TEST_DATA_FILE -Raw

# å‘é€è¯·æ±‚
Write-Host "ğŸ“¤ å‘é€è¯·æ±‚åˆ°: $WEBHOOK_URL" -ForegroundColor Cyan
$headers = @{
    "Content-Type" = "application/json"
    "Authorization" = "Bearer $AUTH_TOKEN"
}

try {
    $startTime = Get-Date
    
    $response = Invoke-RestMethod `
        -Uri $WEBHOOK_URL `
        -Method POST `
        -Headers $headers `
        -Body $testData `
        -TimeoutSec 120
    
    $endTime = Get-Date
    $duration = ($endTime - $startTime).TotalSeconds
    
    # æ˜¾ç¤ºç»“æœ
    Write-Host "`nâœ… è¯·æ±‚æˆåŠŸï¼" -ForegroundColor Green
    Write-Host "â±ï¸  å“åº”æ—¶é—´: $([math]::Round($duration, 2)) ç§’" -ForegroundColor Yellow
    
    # ä¿å­˜å®Œæ•´å“åº”
    $timestamp = Get-Date -Format "yyyyMMdd-HHmmss"
    $resultFile = "test-result-$timestamp.json"
    $response | ConvertTo-Json -Depth 10 | Out-File $resultFile -Encoding UTF8
    Write-Host "ğŸ’¾ å®Œæ•´å“åº”å·²ä¿å­˜: $resultFile" -ForegroundColor Green
    
    # æ˜¾ç¤ºæ‘˜è¦
    Write-Host "`nğŸ“Š ç»“æœæ‘˜è¦:" -ForegroundColor Yellow
    Write-Host "  Session ID: $($response.session_id)"
    Write-Host "  Highlights: $($response.summary_json.highlights.Count) ä¸ª"
    Write-Host "  Keywords: $($response.summary_json.keywords -join ', ')"
    
    Write-Host "`nğŸ“ ç”Ÿæˆçš„ç‰ˆæœ¬:" -ForegroundColor Yellow
    Write-Host "  ç²¾ç®€ç‰ˆ: $($response.outputs.draft_short.Length) å­—ç¬¦"
    Write-Host "  æ­£å¼ç¨¿: $($response.outputs.draft_main.Length) å­—ç¬¦"
    Write-Host "  å¤§çº²: $($response.outputs.outline.Length) å­—ç¬¦"
    Write-Host "  PPT: $($response.outputs.ppt_outline.Length) å­—ç¬¦"
    
    # æ˜¾ç¤ºç²¾ç®€ç‰ˆé¢„è§ˆ
    Write-Host "`nğŸ“„ ç²¾ç®€ç‰ˆé¢„è§ˆ:" -ForegroundColor Cyan
    Write-Host $response.outputs.draft_short
    
} catch {
    Write-Host "`nâŒ è¯·æ±‚å¤±è´¥ï¼" -ForegroundColor Red
    Write-Host "é”™è¯¯ä¿¡æ¯: $($_.Exception.Message)" -ForegroundColor Red
    
    if ($_.Exception.Response) {
        $statusCode = $_.Exception.Response.StatusCode.value__
        Write-Host "HTTP çŠ¶æ€ç : $statusCode" -ForegroundColor Red
        
        # å¸¸è§é”™è¯¯æç¤º
        switch ($statusCode) {
            401 { Write-Host "ğŸ’¡ æç¤º: æ£€æŸ¥ AUTH_TOKEN æ˜¯å¦æ­£ç¡®" -ForegroundColor Yellow }
            404 { Write-Host "ğŸ’¡ æç¤º: æ£€æŸ¥å·¥ä½œæµæ˜¯å¦å·²æ¿€æ´»ï¼ŒWebhook è·¯å¾„æ˜¯å¦æ­£ç¡®" -ForegroundColor Yellow }
            500 { Write-Host "ğŸ’¡ æç¤º: æŸ¥çœ‹ n8n æ‰§è¡Œå†å²ï¼Œæ£€æŸ¥å“ªä¸ªèŠ‚ç‚¹å¤±è´¥" -ForegroundColor Yellow }
        }
    }
}
```

ä¿å­˜ä¸º `quick-test.ps1`ï¼Œç„¶åè¿è¡Œ:

```powershell
cd r:\Talk2Report\å·¥ä½œæµ
.\quick-test.ps1
```

---

## curl ç‰ˆæœ¬ï¼ˆè·¨å¹³å°ï¼‰

```bash
#!/bin/bash
# å¿«é€Ÿæµ‹è¯• n8n å·¥ä½œæµ

WEBHOOK_URL="https://n8n.neican.ai/webhook/generate"
AUTH_TOKEN="YOUR_TOKEN_HERE"
TEST_DATA_FILE="æµ‹è¯•æ•°æ®_å·¥ä½œæ€»ç»“ç”Ÿæˆ.json"

echo "ğŸ“¤ å‘é€æµ‹è¯•è¯·æ±‚..."
curl -X POST "$WEBHOOK_URL" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $AUTH_TOKEN" \
  -d @"$TEST_DATA_FILE" \
  --output "test-result.json" \
  --write-out "\nâœ… HTTP Status: %{http_code}\nâ±ï¸  å“åº”æ—¶é—´: %{time_total}s\n" \
  --silent \
  --show-error

if [ $? -eq 0 ]; then
    echo "ğŸ’¾ ç»“æœå·²ä¿å­˜: test-result.json"
    echo ""
    echo "ğŸ“Š ç²¾ç®€ç‰ˆé¢„è§ˆ:"
    cat test-result.json | jq -r '.outputs.draft_short'
else
    echo "âŒ è¯·æ±‚å¤±è´¥"
fi
```

---

## ä¸€é”®æµ‹è¯•ï¼ˆæœ€ç®€å•ï¼‰

åˆ›å»º `test.bat`:

```batch
@echo off
echo ğŸ“¤ æµ‹è¯• n8n å·¥ä½œæµ...
powershell -ExecutionPolicy Bypass -File quick-test.ps1
pause
```

åŒå‡» `test.bat` å³å¯è¿è¡Œæµ‹è¯•ã€‚

---

## éªŒè¯è„šæœ¬

æµ‹è¯•å®Œæˆåï¼Œè¿è¡ŒéªŒè¯è„šæœ¬æ£€æŸ¥è´¨é‡:

```powershell
# validate-result.ps1
param(
    [string]$ResultFile = "test-result.json"
)

$result = Get-Content $ResultFile -Raw | ConvertFrom-Json

Write-Host "`nğŸ” è´¨é‡éªŒè¯" -ForegroundColor Cyan

# æ£€æŸ¥å¿…éœ€å­—æ®µ
$checks = @{
    "Session ID å­˜åœ¨" = $null -ne $result.session_id
    "Summary JSON å­˜åœ¨" = $null -ne $result.summary_json
    "Outputs å­˜åœ¨" = $null -ne $result.outputs
    "ç²¾ç®€ç‰ˆå­˜åœ¨" = $null -ne $result.outputs.draft_short
    "æ­£å¼ç¨¿å­˜åœ¨" = $null -ne $result.outputs.draft_main
    "å¤§çº²å­˜åœ¨" = $null -ne $result.outputs.outline
    "PPT æçº²å­˜åœ¨" = $null -ne $result.outputs.ppt_outline
}

foreach ($check in $checks.GetEnumerator()) {
    $status = if ($check.Value) { "âœ…" } else { "âŒ" }
    Write-Host "$status $($check.Key)"
}

# æ£€æŸ¥å¥—è¯
$boilerplate = @("ç§¯æ", "è®¤çœŸ", "åŠªåŠ›", "ä¸»åŠ¨", "æ˜¾è‘—æå‡", "å¤§å¹…å¢é•¿")
$draftMain = $result.outputs.draft_main
$foundBoilerplate = @()

foreach ($word in $boilerplate) {
    if ($draftMain -match $word) {
        $foundBoilerplate += $word
    }
}

if ($foundBoilerplate.Count -gt 0) {
    Write-Host "`nâš ï¸  å‘ç°å¥—è¯: $($foundBoilerplate -join ', ')" -ForegroundColor Yellow
} else {
    Write-Host "`nâœ… æ— å¥—è¯ï¼Œè´¨é‡è‰¯å¥½" -ForegroundColor Green
}

# æ£€æŸ¥å­—æ•°
$shortLength = $result.outputs.draft_short.Length
$mainLength = $result.outputs.draft_main.Length

Write-Host "`nğŸ“ å­—æ•°æ£€æŸ¥:" -ForegroundColor Cyan
Write-Host "  ç²¾ç®€ç‰ˆ: $shortLength å­—ç¬¦ $(if ($shortLength -ge 150 -and $shortLength -le 250) {'âœ…'} else {'âš ï¸'})"
Write-Host "  æ­£å¼ç¨¿: $mainLength å­—ç¬¦ $(if ($mainLength -ge 800 -and $mainLength -le 1500) {'âœ…'} else {'âš ï¸'})"
```

ä½¿ç”¨:
```powershell
.\validate-result.ps1 -ResultFile "test-result-20251228-223500.json"
```
