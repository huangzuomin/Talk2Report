# å·¥ä½œæµæµ‹è¯•æŒ‡å—

## ğŸ“‹ æµ‹è¯•æ•°æ®è¯´æ˜

æœ¬æ–‡æ¡£æä¾›äº†æµ‹è¯• `Talk2Report` å·¥ä½œæµçš„å®Œæ•´æ•°æ®å’Œæ­¥éª¤ã€‚

---

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1: å®Œæ•´åŠŸèƒ½æµ‹è¯•ï¼ˆæ¨èï¼‰

**ç›®çš„ï¼š** æµ‹è¯•å®Œæ•´çš„å·¥ä½œæµç¨‹ï¼ŒåŒ…æ‹¬è¾“å…¥éªŒè¯ã€AIæŠ½å–ã€AIç”Ÿæˆ

**æµ‹è¯•æ•°æ®æ–‡ä»¶ï¼š** `æµ‹è¯•æ•°æ®_å·¥ä½œæ€»ç»“ç”Ÿæˆ.json`

---

## ğŸ“¦ æµ‹è¯•æ•°æ®ç»“æ„

### 1. åŸºæœ¬ç»“æ„

```json
{
  "body": {
    "session_id": "å”¯ä¸€ä¼šè¯ID",
    "answers": {
      // è®¿è°ˆå›ç­”æ•°æ®
    },
    "params": {
      "audience": "ç›®æ ‡å—ä¼—",
      "tone": "é£æ ¼",
      "length": "å­—æ•°"
    }
  }
}
```

### 2. answers å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|------|------|------|--------|
| personal_info | object | ä¸ªäººä¿¡æ¯ | å§“åã€éƒ¨é—¨ã€èŒä½ç­‰ |
| achievements | object | å·¥ä½œæˆæœ | é¡¹ç›®ã€Bugä¿®å¤ã€æ€§èƒ½ä¼˜åŒ–ç­‰ |
| skills_growth | object | æŠ€èƒ½æˆé•¿ | æ–°æŠ€èƒ½ã€åŸ¹è®­ã€è®¤è¯ç­‰ |
| team_collaboration | object | å›¢é˜Ÿåä½œ | æŒ‡å¯¼ã€åˆ†äº«ã€è·¨å›¢é˜Ÿåä½œ |
| challenges_overcome | object | å…‹æœçš„æŒ‘æˆ˜ | æŠ€æœ¯æŒ‘æˆ˜åŠè§£å†³æ–¹æ¡ˆ |
| areas_for_improvement | object | æ”¹è¿›æ–¹å‘ | ä¸è¶³å’Œæ”¹è¿›è®¡åˆ’ |
| goals_and_plans | object | ç›®æ ‡å’Œè§„åˆ’ | å­£åº¦å’Œå¹´åº¦ç›®æ ‡ |
| team_feedback | array | å›¢é˜Ÿåé¦ˆ | åŒäº‹è¯„ä»· |
| numbers_and_metrics | object | å…³é”®æ•°æ® | é‡åŒ–æˆæœ |
| awards_and_recognition | object | å¥–é¡¹å’Œè®¤å¯ | å¥–åŠ±ã€æ„Ÿè°¢ |

### 3. params å­—æ®µè¯´æ˜

| å‚æ•° | å¯é€‰å€¼ | è¯´æ˜ |
|------|--------|------|
| audience | `manager` / `hr` / `team` / `client` | ç›®æ ‡å—ä¼— |
| tone | `professional` / `casual` / `formal` / `friendly` | å†™ä½œé£æ ¼ |
| length | `short` / `medium` / `long` | æŠ¥å‘Šé•¿åº¦ |

---

## ğŸš€ æµ‹è¯•æ­¥éª¤

### æ–¹æ³• 1: ä½¿ç”¨ cURL

```bash
# è®¾ç½® n8n æœåŠ¡å™¨åœ°å€
N8N_URL="http://localhost:5678"
N8N_PATH="/webhook/generate"
SECRET_KEY="your-secret-key"  # ä» n8n webhook é…ç½®ä¸­è·å–

# å‘é€æµ‹è¯•è¯·æ±‚
curl -X POST "${N8N_URL}${N8N_PATH}" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${SECRET_KEY}" \
  -d @æµ‹è¯•æ•°æ®_å·¥ä½œæ€»ç»“ç”Ÿæˆ.json
```

### æ–¹æ³• 2: ä½¿ç”¨ PowerShell

```powershell
# è®¾ç½®å˜é‡
$uri = "http://localhost:5678/webhook/generate"
$secretKey = "your-secret-key"

# è¯»å–æµ‹è¯•æ•°æ®
$body = Get-Content "æµ‹è¯•æ•°æ®_å·¥ä½œæ€»ç»“ç”Ÿæˆ.json" -Raw | ConvertFrom-Json

# å‘é€è¯·æ±‚
Invoke-RestMethod -Uri $uri `
  -Method POST `
  -ContentType "application/json" `
  -Headers @{ "Authorization" = "Bearer $secretKey" } `
  -Body (ConvertTo-Json $body -Depth 10)
```

### æ–¹æ³• 3: ä½¿ç”¨ Postman

1. **åˆ›å»ºæ–°è¯·æ±‚**
   - Method: `POST`
   - URL: `http://localhost:5678/webhook/generate`

2. **è®¾ç½® Headers**
   - `Content-Type`: `application/json`
   - `Authorization`: `Bearer your-secret-key`

3. **è®¾ç½® Body**
   - Type: `raw`
   - Format: `JSON`
   - å¤åˆ¶ `æµ‹è¯•æ•°æ®_å·¥ä½œæ€»ç»“ç”Ÿæˆ.json` çš„å†…å®¹

4. **å‘é€è¯·æ±‚å¹¶æŸ¥çœ‹å“åº”**

---

## âœ… é¢„æœŸå“åº”

### æˆåŠŸå“åº” (200 OK)

```json
{
  "success": true,
  "session_id": "test-session-2025-12-28-001",
  "data": {
    "summary": {
      // æŠ½å–çš„ç»“æ„åŒ–æ•°æ®
      "personal_info": {...},
      "achievements": {...},
      // ...
    },
    "outputs": {
      "draft_short": "200å­—ç²¾ç®€ç‰ˆ...",
      "draft_main": "800-1500å­—æ­£å¼ç¨¿...",
      "outline": "# å·¥ä½œæ€»ç»“\n## ä¸€ã€å·¥ä½œæˆæœ...",
      "ppt_outline": "PPTæçº²..."
    }
  },
  "metadata": {
    "timestamp": "2025-12-28T16:30:00.000Z",
    "processing_time_ms": 3245,
    "version": "2.1-n8n2.0"
  }
}
```

### éªŒè¯å¤±è´¥å“åº” (400 Bad Request)

```json
{
  "success": false,
  "error": "Validation failed",
  "message": "Missing required fields: session_id, answers, or params"
}
```

### AI å¤„ç†å¤±è´¥å“åº” (500 Internal Server Error)

```json
{
  "success": false,
  "error": "Extractor è¾“å‡ºæ ¼å¼é”™è¯¯" æˆ– "Writer è¾“å‡ºæ ¼å¼é”™è¯¯",
  "details": "å…·ä½“é”™è¯¯ä¿¡æ¯",
  "session_id": "test-session-2025-12-28-001"
}
```

---

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹é›†

### æµ‹è¯•ç”¨ä¾‹ 1: æ ‡å‡†åœºæ™¯

**è¾“å…¥ï¼š** ä½¿ç”¨ `æµ‹è¯•æ•°æ®_å·¥ä½œæ€»ç»“ç”Ÿæˆ.json`

**é¢„æœŸï¼š**
- âœ… éªŒè¯é€šè¿‡
- âœ… AI æŠ½å–æˆåŠŸ
- âœ… AI ç”Ÿæˆå››ç‰ˆæœ¬æ–‡æœ¬
- âœ… å“åº”æ—¶é—´ < 10ç§’

### æµ‹è¯•ç”¨ä¾‹ 2: ç¼ºå°‘å¿…å¡«å­—æ®µ

**è¾“å…¥ï¼š**
```json
{
  "body": {
    "session_id": "test-001"
    // ç¼ºå°‘ answers å’Œ params
  }
}
```

**é¢„æœŸï¼š**
- âœ… è¿”å› 400 é”™è¯¯
- âœ… é”™è¯¯æ¶ˆæ¯æ˜ç¡®è¯´æ˜ç¼ºå°‘å­—æ®µ

### æµ‹è¯•ç”¨ä¾‹ 3: ç©ºæ•°æ®æµ‹è¯•

**è¾“å…¥ï¼š**
```json
{
  "body": {
    "session_id": "test-003",
    "answers": {},
    "params": {
      "audience": "manager",
      "tone": "professional",
      "length": "medium"
    }
  }
}
```

**é¢„æœŸï¼š**
- âœ… éªŒè¯é€šè¿‡
- âœ… AI èƒ½å¤Ÿå¤„ç†ç©ºæ•°æ®ï¼ˆç”Ÿæˆæ¨¡æ¿åŒ–æ–‡æœ¬ï¼‰
- âœ… è¾“å‡ºä¸­ null å­—æ®µè¢«æ­£ç¡®å¤„ç†

### æµ‹è¯•ç”¨ä¾‹ 4: ä¸åŒå‚æ•°ç»„åˆ

**4.1 æ­£å¼é£æ ¼ + ç®¡ç†è€…å—ä¼—**
```json
{
  "params": {
    "audience": "manager",
    "tone": "formal",
    "length": "long"
  }
}
```

**4.2 è½»æ¾é£æ ¼ + å›¢é˜Ÿå—ä¼—**
```json
{
  "params": {
    "audience": "team",
    "tone": "casual",
    "length": "short"
  }
}
```

**é¢„æœŸï¼š**
- âœ… ç”Ÿæˆçš„æ–‡æœ¬é£æ ¼ç¬¦åˆå‚æ•°è®¾ç½®
- âœ… å­—æ•°æ§åˆ¶åœ¨æŒ‡å®šèŒƒå›´å†…

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹ n8n æ‰§è¡Œæ—¥å¿—

```bash
# åœ¨ n8n ç•Œé¢ä¸­
1. ç‚¹å‡» "Executions"
2. æ‰¾åˆ°å¯¹åº”çš„æ‰§è¡Œè®°å½•
3. ç‚¹å‡»æŸ¥çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„è¾“å…¥è¾“å‡º
```

### 2. æ£€æŸ¥ AI Agent è¾“å‡º

åœ¨ n8n æ‰§è¡Œæ—¥å¿—ä¸­ï¼š
- æŸ¥çœ‹ **Extractor Agent** èŠ‚ç‚¹çš„ `output` å­—æ®µ
- ç¡®è®¤æ˜¯å¦ä¸ºæœ‰æ•ˆçš„ JSON æ ¼å¼
- æ£€æŸ¥æ˜¯å¦åŒ…å«æ‰€æœ‰éœ€è¦çš„å­—æ®µ

### 3. æ£€æŸ¥è¿æ¥

ç¡®è®¤èŠ‚ç‚¹è¿æ¥æ­£ç¡®ï¼š
- Webhook â†’ Validate Input â†’ Check Validation
- Check Validation â†’ Set Variables (true åˆ†æ”¯)
- Check Validation â†’ Validation Error (false åˆ†æ”¯)
- Set Variables â†’ Extractor Agent
- Extractor Agent â†’ Check Extractor Error
- Extractor Agent çš„ chatModel â†’ OpenAI Chat Model

### 4. æµ‹è¯•å•ä¸ªèŠ‚ç‚¹

åœ¨ n8n ç¼–è¾‘å™¨ä¸­ï¼š
1. å³é”®ç‚¹å‡»ä»»æ„èŠ‚ç‚¹
2. é€‰æ‹© "Execute node"
3. æŸ¥çœ‹è¯¥èŠ‚ç‚¹çš„ç‹¬ç«‹æ‰§è¡Œç»“æœ

---

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜ 1: 401 Unauthorized

**åŸå› ï¼š** API å¯†é’¥é…ç½®é”™è¯¯

**è§£å†³ï¼š**
- æ£€æŸ¥ n8n Webhook èŠ‚ç‚¹çš„è®¤è¯é…ç½®
- ç¡®è®¤è¯·æ±‚å¤´ä¸­çš„ Authorization å€¼æ­£ç¡®

### é—®é¢˜ 2: 500 Internal Server Error

**å¯èƒ½åŸå› ï¼š**
1. OpenAI API è°ƒç”¨å¤±è´¥
2. æ¨¡å‹å“åº”æ ¼å¼ä¸æ­£ç¡®
3. å‡­è¯é…ç½®é”™è¯¯

**æ’æŸ¥æ­¥éª¤ï¼š**
1. æŸ¥çœ‹ n8n æ‰§è¡Œæ—¥å¿—
2. æ£€æŸ¥ Extractor Agent / Writer Agent çš„é”™è¯¯è¾“å‡º
3. éªŒè¯ç¡…åŸºæµåŠ¨ API å‡­è¯æ˜¯å¦æ­£ç¡®
4. ç¡®è®¤æ¨¡å‹ `Qwen/Qwen2.5-7B-Instruct` å¯ç”¨

### é—®é¢˜ 3: JSON è§£æå¤±è´¥

**å¯èƒ½åŸå› ï¼š**
- AI è¾“å‡ºä¸æ˜¯çº¯ JSON
- è¾“å‡ºåŒ…å«é¢å¤–çš„æ–‡å­—è¯´æ˜

**è§£å†³ï¼š**
- åœ¨ systemMessage ä¸­å¼ºè°ƒ"åªè¾“å‡º JSONï¼Œä¸è¦ä»»ä½•è§£é‡Š"
- æ£€æŸ¥ AI æ¨¡å‹çš„ `responseFormat` é…ç½®

### é—®é¢˜ 4: å“åº”æ—¶é—´è¿‡é•¿

**åŸå› ï¼š** AI æ¨¡å‹å¤„ç†æ—¶é—´è¿‡é•¿

**ä¼˜åŒ–ï¼š**
- å‡å°‘ `maxTokens` è®¾ç½®
- ç®€åŒ–è¾“å…¥æ•°æ®
- ä½¿ç”¨æ›´å¿«çš„æ¨¡å‹ï¼ˆå¦‚ Qwen2.5-7Bï¼‰

---

## ğŸ“Š æ€§èƒ½åŸºå‡†

æ ¹æ®å®é™…æµ‹è¯•ï¼Œé¢„æœŸçš„æ€§èƒ½æŒ‡æ ‡ï¼š

| æ“ä½œ | é¢„æœŸæ—¶é—´ | è¯´æ˜ |
|------|---------|------|
| è¾“å…¥éªŒè¯ | < 50ms | æ•°æ®éªŒè¯é€»è¾‘ |
| AI ä¿¡æ¯æŠ½å– | 2-5ç§’ | å–å†³äº answers æ•°æ®é‡ |
| AI æŠ¥å‘Šç”Ÿæˆ | 3-8ç§’ | ç”Ÿæˆ4ä¸ªç‰ˆæœ¬ |
| æ€»å¤„ç†æ—¶é—´ | 5-13ç§’ | ç«¯åˆ°ç«¯æ—¶é—´ |

**æ³¨æ„ï¼š** å®é™…æ—¶é—´å–å†³äºï¼š
- ç½‘ç»œå»¶è¿Ÿ
- API æœåŠ¡è´Ÿè½½
- è¾“å…¥æ•°æ®å¤§å°
- æ¨¡å‹å“åº”é€Ÿåº¦

---

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

å®Œæˆæµ‹è¯•åï¼Œå¡«å†™ä»¥ä¸‹æŠ¥å‘Šï¼š

```markdown
## æµ‹è¯•æ‰§è¡ŒæŠ¥å‘Š

**æµ‹è¯•æ—¥æœŸï¼š** YYYY-MM-DD
**æµ‹è¯•äººå‘˜ï¼š** XXX
**n8n ç‰ˆæœ¬ï¼š** 2.0+

### æµ‹è¯•ç»“æœ

| æµ‹è¯•ç”¨ä¾‹ | çŠ¶æ€ | å“åº”æ—¶é—´ | å¤‡æ³¨ |
|---------|------|---------|------|
| æ ‡å‡†åœºæ™¯ | âœ… / âŒ | XXXms | |
| ç¼ºå°‘å­—æ®µ | âœ… / âŒ | XXXms | |
| ç©ºæ•°æ® | âœ… / âŒ | XXXms | |
| ä¸åŒå‚æ•° | âœ… / âŒ | XXXms | |

### é—®é¢˜è®°å½•

1. **é—®é¢˜æè¿°ï¼š**
   - å¤ç°æ­¥éª¤ï¼š
   - é”™è¯¯ä¿¡æ¯ï¼š
   - è§£å†³æ–¹æ¡ˆï¼š

2. **é—®é¢˜æè¿°ï¼š**
   - ...

### ç»“è®º

- [ ] å·¥ä½œæµåŠŸèƒ½æ­£å¸¸ï¼Œå¯ä»¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- [ ] å­˜åœ¨é—®é¢˜ï¼Œéœ€è¦ä¿®å¤ï¼š
  - é—®é¢˜1ï¼š
  - é—®é¢˜2ï¼š
```

---

## ğŸ¯ è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬

### Bash æµ‹è¯•è„šæœ¬

```bash
#!/bin/bash

# é…ç½®
N8N_URL="http://localhost:5678"
SECRET_KEY="your-secret-key"

# é¢œè‰²è¾“å‡º
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m' # No Color

echo "å¼€å§‹æµ‹è¯• Talk2Report å·¥ä½œæµ..."
echo ""

# æµ‹è¯•1: æ ‡å‡†åœºæ™¯
echo "æµ‹è¯•1: æ ‡å‡†åœºæ™¯"
response=$(curl -s -X POST "${N8N_URL}/webhook/generate" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${SECRET_KEY}" \
  -d @æµ‹è¯•æ•°æ®_å·¥ä½œæ€»ç»“ç”Ÿæˆ.json)

if echo "$response" | grep -q '"success": true'; then
  echo -e "${GREEN}âœ… æµ‹è¯•1 é€šè¿‡${NC}"
else
  echo -e "${RED}âŒ æµ‹è¯•1 å¤±è´¥${NC}"
  echo "å“åº”ï¼š$response"
fi

# æµ‹è¯•2: ç¼ºå°‘å­—æ®µ
echo ""
echo "æµ‹è¯•2: ç¼ºå°‘å­—æ®µéªŒè¯"
response=$(curl -s -X POST "${N8N_URL}/webhook/generate" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${SECRET_KEY}" \
  -d '{"body":{"session_id":"test-001"}}')

if echo "$response" | grep -q '"error": "Validation failed"'; then
  echo -e "${GREEN}âœ… æµ‹è¯•2 é€šè¿‡${NC}"
else
  echo -e "${RED}âŒ æµ‹è¯•2 å¤±è´¥${NC}"
  echo "å“åº”ï¼š$response"
fi

echo ""
echo "æµ‹è¯•å®Œæˆï¼"
```

ä¿å­˜ä¸º `test_workflow.sh`ï¼Œæ‰§è¡Œï¼š
```bash
chmod +x test_workflow.sh
./test_workflow.sh
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å·¥ä½œæµä¼˜åŒ–è¯´æ˜æ–‡æ¡£.md](./å·¥ä½œæµä¼˜åŒ–è¯´æ˜æ–‡æ¡£.md)
- [8_2.0_AI_Agentè¿ç§»è¯´æ˜.md](./8_2.0_AI_Agentè¿ç§»è¯´æ˜.md)
- [å·¥ä½œæ€»ç»“æ¨¡æ¿å‚è€ƒ.md](./å·¥ä½œæ€»ç»“æ¨¡æ¿å‚è€ƒ.md)

---

**æœ€åæ›´æ–°ï¼š** 2025-12-28
**ç‰ˆæœ¬ï¼š** 1.0
